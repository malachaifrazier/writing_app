<article class="article">
	<div class="breadcrumb">
	  <%= link_to 'Dashboard', home_index_path %>
	  <%= link_to 'My Projects', projects_path %>
	   <%= link_to 'Project', project_goals_path(@project), class: "current-selection" %>
	</div>

	<h1 class="main-title">Project Details</h1>
	
	<div class="card project">
    	<div class="card-image">
        	<h3 class="card-image title"><%= @project.name %></h3> 
        </div>

        <div class="card-header">
            <%= @project.type_is.capitalize %>
        </div>

        <div class="card-copy">
            <% if @project.deadline %>
              <p>Deadline: <%= @project.deadline.strftime("%A, %b %d") %> </p>
            <% end %>
        

 	 		<% if time_left(@project.deadline) >= 0 %>
				You have <%= time_left(@project.deadline) %> days left to finish this project. <br>
			<% else %>
				<strong>Your deadline is past due!</strong> <br>
			<% end %>
		</div>

		<div class="card-stats">
	        <ul>
	          <li><%= ChronicDuration.output(@project.total_time_spent, :format => :short, :units => 2) %><span>Time Spent</span></li>
	          <li><%= @project.goals.length %><span>Goals</span></li>
	          	
	          	<% if @project.deadline %>
	            	<li><%= time_left(@project.deadline) %><span>Days Left</span></li>
	          	<% end %>
	        </ul>
    	</div>
	  
		<div class="inner-project">
			<% @goals.each do |goal| %>
					<div class="card">
			    		<div class="card-image">
			      			<h3 class="card-image title"><%= link_to goal.type_is.capitalize, goal_path(goal), class: "card-image title" %></h3> 
			    		</div>
	
			    		<div class="card-header">
							
						</div>
	
			   			<div class="card-copy">
			   				<% if goal.deadline %>
								<p>Deadline: <%= goal.deadline.strftime("%A, %b %d") %> </p>
							<% end %>
			    		</div>
	
			    		<div class="card-stats">
			      			<ul>
			        			<li><%= ChronicDuration.output(goal.total_time_spent, :format => :short, :units => 2) %><span>Time Spent</span></li>
			        			<% if goal.entries %>
			        				<li><%= goal.entries.length %><span>Entries</span></li>
			        			<% end %>
			        			<% if goal.deadline %>
			       					<li><%= time_left(goal.deadline) %><span>Days Left</span></li>
			       				<% end %>
			      			</ul>
			      			<ul class="edit-button">
        						<li><span class="edit"><%= link_to 'Edit', edit_project_path(@project) %></span></li>
          						<li ><span class="edit"><%= link_to "Write Now!", new_project_entry_path(:project_id => goal.project_id, :goal_id => goal) %></span></li>
        					</ul>
			    		</div>
			  		</div>
			<% end %>
		</div>


	<div class="card-stats">
        <ul class="edit-button">
        	<li><span class="edit"><%= link_to "New Goal", new_project_goal_path(@project) %></span></li>
          	<li ><span class="edit"><%= link_to 'Edit', edit_project_path(@project) %></span></li>
        </ul>
    </div>
</div>

</article>

<section class="stats">
	<h3>Stats</h3>
	<em>goal#index</em><br> 
	Deadline: <%= @project.deadline.strftime("%A, %b %d") %>
	<% if @project.entries.empty? %>
		<% else %>
			<div>
				
					<p>You've spent <%= distance_of_time_in_words(@project.total_time_spent) %> on this project.</p>
					<p>Your hours over the last 7 days: <span class="inlinesparkline"><%= @project.spark_line %></span>
	</p>
			</div>
		<% end %>
</section>